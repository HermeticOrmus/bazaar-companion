<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Bazaar Companion</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <header class="header">
    <div class="header-content">
      <h1 class="logo">Bazaar <span class="accent">Companion</span></h1>
      <nav class="nav-tabs">
        <button class="tab active" data-tab="meta">Meta</button>
        <button class="tab" data-tab="guides">Guides</button>
        <button class="tab" data-tab="heroes">Heroes</button>
        <button class="tab" data-tab="items">Items</button>
        <button class="tab" data-tab="builds">My Builds</button>
        <button class="tab" data-tab="runs">Runs</button>
        <button class="tab" data-tab="notes">Notes</button>
        <button class="tab" data-tab="progress">Progress</button>
      </nav>
      <button class="theme-toggle" id="themeToggle" title="Toggle theme">
        <span class="icon-sun">‚òÄ</span>
        <span class="icon-moon">‚òæ</span>
      </button>
    </div>
  </header>

  <main class="main">
    <!-- Meta Tab -->
    <section class="tab-content active" id="meta">
      <div class="section-header">
        <h2>Current Meta <span class="badge">Patch 8.0</span></h2>
      </div>

      <div class="tier-list" id="tierList">
        <!-- Tier list is rendered dynamically from JS -->
      </div>
      <p class="tier-hint">Click any build to view guide</p>

      <div class="quick-stats">
        <h3>Key Stats Priority</h3>
        <div class="stat-cards">
          <div class="stat-card gold">
            <span class="stat-rank">1</span>
            <span class="stat-name">CDR</span>
            <span class="stat-desc">Cooldown Reduction - King stat</span>
          </div>
          <div class="stat-card silver">
            <span class="stat-rank">2</span>
            <span class="stat-name">Haste</span>
            <span class="stat-desc">Temporary CDR boost</span>
          </div>
          <div class="stat-card bronze">
            <span class="stat-rank">3</span>
            <span class="stat-name">Crit</span>
            <span class="stat-desc">Scales everything late</span>
          </div>
        </div>
      </div>

      <div class="resources-grid">
        <a href="https://bazaardb.gg/tierlists" target="_blank" class="resource-link">
          <span class="resource-icon">üìä</span>
          <span>BazaarDB Tiers</span>
        </a>
        <a href="https://discord.com/invite/playthebazaar" target="_blank" class="resource-link">
          <span class="resource-icon">üí¨</span>
          <span>Discord</span>
        </a>
        <a href="https://reddit.com/r/PlayTheBazaar" target="_blank" class="resource-link">
          <span class="resource-icon">üì±</span>
          <span>Reddit</span>
        </a>
        <a href="https://bazaar-builds.net" target="_blank" class="resource-link">
          <span class="resource-icon">üèó</span>
          <span>Daily Builds</span>
        </a>
      </div>
    </section>

    <!-- Guides Tab -->
    <section class="tab-content" id="guides">
      <div class="section-header">
        <h2>Build Guides</h2>
        <div class="guide-filters">
          <select id="guideHeroFilter" class="filter-select">
            <option value="">All Heroes</option>
            <option value="vanessa">Vanessa</option>
            <option value="pygmalien">Pygmalien</option>
            <option value="dooley">Dooley</option>
            <option value="mak">Mak</option>
            <option value="stelle">Stelle</option>
            <option value="jules">Jules</option>
          </select>
          <select id="guideTierFilter" class="filter-select">
            <option value="">All Tiers</option>
            <option value="s">S-Tier</option>
            <option value="a">A-Tier</option>
            <option value="b">B-Tier</option>
          </select>
        </div>
      </div>

      <!-- Guide List View -->
      <div class="guides-grid" id="guidesGrid">
        <!-- Rendered by JS -->
      </div>

      <!-- Single Guide View (hidden by default) -->
      <div class="guide-detail" id="guideDetail">
        <div class="guide-detail-header">
          <button class="btn-back" id="backToGuides">‚Üê Back to Guides</button>
          <button class="btn-secondary" onclick="copyGuideToClipboard()">üìã Copy Guide</button>
        </div>

        <div class="guide-header">
          <h2 id="guideTitle">Build Name</h2>
          <div class="guide-tags">
            <span class="guide-hero-tag" id="guideHero">Hero</span>
            <span class="guide-tier-tag" id="guideTier">Tier</span>
          </div>
        </div>

        <div class="guide-overview">
          <div class="guide-section">
            <h3>Overview</h3>
            <p id="guideOverview"></p>
          </div>

          <div class="guide-section win-condition">
            <h3>Win Condition</h3>
            <p id="guideWinCondition"></p>
          </div>
        </div>

        <div class="guide-phases">
          <div class="guide-phase early">
            <h3>Early Game <span class="phase-days">(Days 1-3)</span></h3>
            <ul class="phase-content" id="earlyPhase"></ul>
          </div>
          <div class="guide-phase mid">
            <h3>Mid Game <span class="phase-days">(Days 4-6)</span></h3>
            <ul class="phase-content" id="midPhase"></ul>
          </div>
          <div class="guide-phase late">
            <h3>Late Game <span class="phase-days">(Days 7+)</span></h3>
            <ul class="phase-content" id="latePhase"></ul>
          </div>
        </div>

        <div class="guide-section">
          <h3>Core Items</h3>
          <div class="guide-items" id="guideItems">
            <!-- Item cards rendered here -->
          </div>
        </div>

        <div class="guide-section">
          <h3>Key Synergies</h3>
          <div class="guide-synergies" id="guideSynergies">
            <!-- Synergy cards rendered here -->
          </div>
        </div>

        <div class="guide-section">
          <h3>Board Layout</h3>
          <div class="board-layout" id="guideBoard">
            <!-- Visual board representation -->
          </div>
        </div>

        <div class="guide-section">
          <h3>Tips & Tricks</h3>
          <ul class="guide-tips" id="guideTips">
            <!-- Tips list -->
          </ul>
        </div>

        <div class="guide-section">
          <h3>Counters & Weaknesses</h3>
          <div class="guide-counters">
            <div class="counter-group bad">
              <h4>Bad Matchups</h4>
              <ul id="guideBadMatchups"></ul>
            </div>
            <div class="counter-group weak">
              <h4>Weaknesses</h4>
              <ul id="guideWeaknesses"></ul>
            </div>
          </div>
        </div>

        <div class="guide-section guide-external">
          <h3>External Resources</h3>
          <div class="external-links" id="guideLinks">
            <!-- Links to bazaar-builds.net, mobalytics, etc -->
          </div>
        </div>
      </div>
    </section>

    <!-- Items Tab -->
    <section class="tab-content" id="items">
      <div class="section-header">
        <h2>Item Database</h2>
      </div>
      <div class="search-filters">
        <input type="text" id="itemSearch" placeholder="Search items..." class="search-input">
        <div class="filter-row">
          <select id="heroFilter" class="filter-select">
            <option value="">All Heroes</option>
            <option value="vanessa">Vanessa</option>
            <option value="pygmalien">Pygmalien</option>
            <option value="dooley">Dooley</option>
            <option value="mak">Mak</option>
            <option value="stelle">Stelle</option>
            <option value="jules">Jules</option>
          </select>
          <select id="tierFilter" class="filter-select">
            <option value="">All Tiers</option>
            <option value="bronze">Bronze</option>
            <option value="silver">Silver</option>
            <option value="gold">Gold</option>
            <option value="diamond">Diamond</option>
            <option value="legendary">Legendary</option>
          </select>
          <select id="sizeFilter" class="filter-select">
            <option value="">All Sizes</option>
            <option value="small">Small</option>
            <option value="medium">Medium</option>
            <option value="large">Large</option>
          </select>
        </div>
      </div>
      <div class="items-grid" id="itemsGrid">
        <p class="empty-state">Loading items from BazaarDB...</p>
      </div>
      <div class="items-footer">
        <a href="https://bazaardb.gg" target="_blank" class="btn-secondary">Full Database at BazaarDB.gg</a>
      </div>
    </section>

    <!-- Heroes Tab -->
    <section class="tab-content" id="heroes">
      <div class="section-header">
        <h2>Heroes</h2>
      </div>
      <div class="search-filters">
        <input type="text" id="heroSearch" placeholder="Search heroes or builds..." class="search-input">
        <div class="filter-row">
          <select id="heroDifficultyFilter" class="filter-select">
            <option value="">All Difficulties</option>
            <option value="Beginner">Beginner</option>
            <option value="Intermediate">Intermediate</option>
            <option value="Advanced">Advanced</option>
            <option value="DLC">DLC</option>
          </select>
        </div>
      </div>
      <div class="hero-grid">
        <div class="hero-card vanessa">
          <div class="hero-header">
            <img src="assets/heroes/vanessa.jpg" alt="Vanessa" class="hero-portrait">
            <div class="hero-info">
              <h3>Vanessa</h3>
              <p class="hero-style">Aggression & Damage</p>
              <p class="hero-difficulty">Beginner</p>
            </div>
          </div>
          <div class="hero-builds">
            <span class="build-tag">Slow Burn</span>
            <span class="build-tag">Powder Keg</span>
            <span class="build-tag">Full Ammo</span>
          </div>
        </div>
        <div class="hero-card pygmalien">
          <div class="hero-header">
            <img src="assets/heroes/pygmalien.jpg" alt="Pygmalien" class="hero-portrait">
            <div class="hero-info">
              <h3>Pygmalien</h3>
              <p class="hero-style">Shield & Economy</p>
              <p class="hero-difficulty">Intermediate</p>
            </div>
          </div>
          <div class="hero-builds">
            <span class="build-tag">Jabalian Drum</span>
            <span class="build-tag">Cash Cannon</span>
            <span class="build-tag">Freeze</span>
          </div>
        </div>
        <div class="hero-card dooley">
          <div class="hero-header">
            <img src="assets/heroes/dooley.jpg" alt="Dooley" class="hero-portrait">
            <div class="hero-info">
              <h3>Dooley</h3>
              <p class="hero-style">Chain Reactions</p>
              <p class="hero-difficulty">Advanced</p>
            </div>
          </div>
          <div class="hero-builds">
            <span class="build-tag">Dooltron</span>
            <span class="build-tag">Critical Core</span>
            <span class="build-tag">Friends</span>
          </div>
        </div>
        <div class="hero-card mak">
          <div class="hero-header">
            <img src="assets/heroes/mak.jpg" alt="Mak" class="hero-portrait">
            <div class="hero-info">
              <h3>Mak</h3>
              <p class="hero-style">Potion & Poison</p>
              <p class="hero-difficulty">Intermediate</p>
            </div>
          </div>
          <div class="hero-builds">
            <span class="build-tag">Peacewrought</span>
            <span class="build-tag">Self Poison</span>
            <span class="build-tag">Magic Carpet</span>
          </div>
        </div>
        <div class="hero-card stelle">
          <div class="hero-header">
            <img src="assets/heroes/stelle.jpg" alt="Stelle" class="hero-portrait">
            <div class="hero-info">
              <h3>Stelle</h3>
              <p class="hero-style">Vehicle & Flying</p>
              <p class="hero-difficulty">DLC</p>
            </div>
          </div>
          <div class="hero-builds">
            <span class="build-tag">Coming soon</span>
          </div>
        </div>
        <div class="hero-card jules">
          <div class="hero-header">
            <img src="assets/heroes/jules.jpg" alt="Jules" class="hero-portrait">
            <div class="hero-info">
              <h3>Jules</h3>
              <p class="hero-style">Food & Cooking</p>
              <p class="hero-difficulty">DLC</p>
            </div>
          </div>
          <div class="hero-builds">
            <span class="build-tag">Heated/Chilled</span>
          </div>
        </div>
      </div>
    </section>

    <!-- Builds Tab -->
    <section class="tab-content" id="builds">
      <div class="section-header">
        <h2>Build Planner</h2>
        <button class="btn-primary" id="newBuild">+ New Build</button>
      </div>
      <div class="builds-list" id="buildsList">
        <p class="empty-state">No builds saved yet. Create your first build!</p>
      </div>

      <!-- Build Modal -->
      <div class="modal" id="buildModal">
        <div class="modal-content modal-wide">
          <h3 id="buildModalTitle">New Build</h3>
          <form id="buildForm">
            <input type="hidden" name="buildId" id="buildId">
            <div class="form-row">
              <label>
                Build Name
                <input type="text" name="buildName" required placeholder="e.g., Powder Keg Vanessa">
              </label>
              <label>
                Hero
                <select name="buildHero" required>
                  <option value="">Select...</option>
                  <option value="vanessa">Vanessa</option>
                  <option value="pygmalien">Pygmalien</option>
                  <option value="dooley">Dooley</option>
                  <option value="mak">Mak</option>
                  <option value="stelle">Stelle</option>
                  <option value="jules">Jules</option>
                </select>
              </label>
              <label>
                Tier
                <select name="buildTier">
                  <option value="s">S-Tier</option>
                  <option value="a">A-Tier</option>
                  <option value="b" selected>B-Tier</option>
                  <option value="c">C-Tier</option>
                </select>
              </label>
            </div>
            <label>
              Core Items (comma separated)
              <input type="text" name="coreItems" placeholder="e.g., Powder Keg, Fuse, Cannon">
            </label>
            <label>
              Strategy Notes
              <textarea name="strategy" rows="3" placeholder="How to play this build, key synergies, win conditions..."></textarea>
            </label>
            <label>
              Early Game
              <textarea name="earlyGame" rows="2" placeholder="What to look for Days 1-3..."></textarea>
            </label>
            <label>
              Late Game
              <textarea name="lateGame" rows="2" placeholder="Scaling, final board setup..."></textarea>
            </label>
            <div class="modal-actions">
              <button type="button" class="btn-secondary" id="cancelBuild">Cancel</button>
              <button type="submit" class="btn-primary">Save Build</button>
            </div>
          </form>
        </div>
      </div>
    </section>

    <!-- Runs Tab -->
    <section class="tab-content" id="runs">
      <div class="section-header">
        <h2>Run Tracker</h2>
        <button class="btn-primary" id="newRun">+ New Run</button>
      </div>
      <div class="runs-list" id="runsList">
        <p class="empty-state">No runs logged yet. Start tracking your progress!</p>
      </div>

      <!-- New Run Modal -->
      <div class="modal" id="runModal">
        <div class="modal-content">
          <h3>Log New Run</h3>
          <form id="runForm">
            <label>
              Hero
              <select name="hero" required>
                <option value="">Select hero...</option>
                <option value="vanessa">Vanessa</option>
                <option value="pygmalien">Pygmalien</option>
                <option value="dooley">Dooley</option>
                <option value="mak">Mak</option>
                <option value="stelle">Stelle</option>
                <option value="jules">Jules</option>
              </select>
            </label>
            <label>
              Wins
              <input type="number" name="wins" min="0" max="10" required>
            </label>
            <label>
              Build Type
              <input type="text" name="build" placeholder="e.g., Powder Keg">
            </label>
            <label>
              Notes
              <textarea name="notes" rows="3" placeholder="What worked? What didn't?"></textarea>
            </label>
            <div class="modal-actions">
              <button type="button" class="btn-secondary" id="cancelRun">Cancel</button>
              <button type="submit" class="btn-primary">Save Run</button>
            </div>
          </form>
        </div>
      </div>
    </section>

    <!-- Notes Tab (Voice Transcriptions) -->
    <section class="tab-content" id="notes">
      <div class="section-header">
        <h2>Voice Notes</h2>
      </div>

      <!-- Voice Recorder Panel -->
      <div class="voice-recorder" id="voiceRecorder">
        <div class="recorder-main">
          <button class="record-btn" id="recordBtn" title="Click to record">
            <span class="mic-icon">üé§</span>
          </button>
          <div class="recorder-status">
            <span id="recorderStatus">Click to record</span>
            <span class="recording-time" id="recordingTime">0:00</span>
          </div>
        </div>
        <div class="recorder-controls" id="recorderControls" style="display: none;">
          <button class="btn-secondary" id="cancelRecording">Cancel</button>
          <button class="btn-primary" id="saveRecording">Save Note</button>
        </div>
        <div class="transcription-preview" id="transcriptionPreview" style="display: none;">
          <div class="transcription-label">Transcription:</div>
          <div class="transcription-text" id="transcriptionText"></div>
          <div class="transcription-status" id="transcriptionStatus"></div>
        </div>
      </div>

      <div class="notes-info">
        <p class="info-text">
          Record voice notes during gameplay. Notes are <strong>auto-tagged</strong> by hero, mechanic, and sentiment.
          Transcription uses local Whisper - no data leaves your machine.
        </p>
        <div class="notes-search">
          <input type="text" id="noteSearch" placeholder="Search notes..." class="search-input">
        </div>
      </div>
      <div class="notes-list" id="notesList">
        <p class="empty-state">No voice notes yet. Click the microphone to start!</p>
      </div>

      <!-- Note Modal -->
      <div class="modal" id="noteModal">
        <div class="modal-content">
          <h3>Voice Note</h3>
          <div class="note-full-content" id="noteContent"></div>
          <div class="note-full-tags" id="noteModalTags"></div>
          <div class="note-meta" id="noteMeta"></div>
          <div class="modal-actions">
            <button type="button" class="btn-secondary" id="closeNote">Close</button>
            <button type="button" class="btn-danger" id="deleteNote">Delete</button>
          </div>
        </div>
      </div>
    </section>

    <!-- Progress Tab -->
    <section class="tab-content" id="progress">
      <div class="section-header">
        <h2>Progress</h2>
      </div>

      <div class="stats-overview">
        <div class="stat-box">
          <span class="stat-value" id="totalRuns">0</span>
          <span class="stat-label">Total Runs</span>
        </div>
        <div class="stat-box">
          <span class="stat-value" id="avgWins">0</span>
          <span class="stat-label">Avg Wins</span>
        </div>
        <div class="stat-box">
          <span class="stat-value" id="bestRun">0</span>
          <span class="stat-label">Best Run</span>
        </div>
        <div class="stat-box">
          <span class="stat-value" id="tenWins">0</span>
          <span class="stat-label">10-Wins</span>
        </div>
      </div>

      <div class="milestones">
        <h3>Milestones</h3>
        <div class="milestone-list">
          <label class="milestone">
            <input type="checkbox" id="m1"> Complete first run
          </label>
          <label class="milestone">
            <input type="checkbox" id="m2"> Reach 5 wins
          </label>
          <label class="milestone">
            <input type="checkbox" id="m3"> Reach 10 wins
          </label>
          <label class="milestone">
            <input type="checkbox" id="m4"> Win with each base hero
          </label>
          <label class="milestone">
            <input type="checkbox" id="m5"> Consistent 6+ wins
          </label>
        </div>
      </div>
    </section>
  </main>

  <script src="app.js"></script>
</body>
</html>
